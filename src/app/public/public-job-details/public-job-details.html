<div class="public-job-details">
  <header class="public-job-details__header" role="banner">
    <mat-toolbar class="public-job-details__toolbar">
      <div class="public-job-details__toolbar-inner">
        <a
          mat-button
          class="public-job-details__back"
          [routerLink]="['/t', slug, 'jobs']"
        >
          <mat-icon>arrow_back</mat-icon>
          <span>All jobs</span>
        </a>

        <div class="public-job-details__heading">
          <div class="public-job-details__role-label">
            Application
          </div>
          <div class="public-job-details__company">
            {{ companyName() || 'Careers' }}
          </div>
        </div>
      </div>
    </mat-toolbar>
  </header>

  <main class="public-job-details__main" role="main">
    <section class="public-job-details__intro">
      <h1 class="public-job-details__title">
        Submit your application
      </h1>
      <p class="public-job-details__subtitle">
        Share your details and resume to be considered for this opportunity.
      </p>
    </section>

    <section class="public-job-details__content" aria-label="Job details and application form">
      <div
        *ngIf="loading(); else content"
        class="public-job-details__loading"
        role="status"
        aria-live="polite"
      >
        <mat-spinner diameter="34"></mat-spinner>
        <div class="public-job-details__loading-text">Loading…</div>
      </div>

      <ng-template #content>
        <div class="public-job-details__layout" *ngIf="job() as j">
          <div class="public-job-details__left">
            <mat-card class="public-job-details__card public-job-details__card--job">
              <div class="public-job-details__job-title">{{ j.title }}</div>
              <div class="public-job-details__job-meta">
                {{ j.department }} • {{ j.location || '—' }}
              </div>
              <div class="public-job-details__job-desc">{{ j.description }}</div>
            </mat-card>

            <div *ngIf="logo()" class="public-job-details__logo-wrapper">
              <img
                class="public-job-details__logo-image"
                [src]="logo()"
                [alt]="companyName() || j.title || 'Company logo'"
              />
              <div class="public-job-details__logo-caption">
                Careers at {{ companyName() || 'our organization' }}
              </div>
            </div>
          </div>

          <mat-card class="public-job-details__card public-job-details__card--form">
            <div class="public-job-details__form-title">Your information</div>

            <form
              class="public-job-details__form-grid"
              [formGroup]="form"
              (ngSubmit)="submit()"
            >
              <mat-form-field appearance="outline">
                <mat-label>Full Name</mat-label>
                <input matInput formControlName="fullName" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Email</mat-label>
                <input matInput formControlName="email" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Phone</mat-label>
                <input matInput formControlName="phone" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Address</mat-label>
                <input matInput formControlName="addressLine" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Previous Company</mat-label>
                <input matInput formControlName="previousCompanyName" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Years of Experience</mat-label>
                <input matInput type="number" formControlName="noOfYearExperience" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Institute</mat-label>
                <input matInput formControlName="instituteName" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Subject</mat-label>
                <input matInput formControlName="subject" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Expected Salary</mat-label>
                <input matInput type="number" formControlName="expectedSalary" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Currency</mat-label>
                <input matInput formControlName="salaryCurrency" />
              </mat-form-field>

              <div class="public-job-details__form-full">
                <label class="public-job-details__file">
                  <input
                    type="file"
                    (change)="pickFile($event)"
                    accept=".pdf,.doc,.docx"
                  />
                  <span>
                    <mat-icon>upload</mat-icon>
                    {{ resumeFile()?.name || 'Upload CV (pdf/doc/docx)' }}
                  </span>
                </label>
              </div>

              <mat-form-field
                appearance="outline"
                class="public-job-details__form-full"
              >
                <mat-label>Notes (optional)</mat-label>
                <textarea matInput rows="4" formControlName="notes"></textarea>
              </mat-form-field>

              <div class="public-job-details__form-full public-job-details__actions">
                <button
                  mat-flat-button
                  color="primary"
                  class="public-job-details__submit"
                  type="submit"
                  [disabled]="submitting()"
                >
                  <mat-icon>send</mat-icon>
                  Submit application
                </button>

                <mat-spinner *ngIf="submitting()" diameter="24"></mat-spinner>
              </div>
            </form>
          </mat-card>
        </div>
      </ng-template>
    </section>
  </main>
</div>
